authelia:
  image:
    registry: ghcr.io
    repository: authelia/authelia
    tag: '4.37'
  domain: amrap030.site
  pod:
    kind: Deployment
    extraVolumeMounts:
      - name: users
        mountPath: /users.yaml
        subPath: users.yaml
        readOnly: true
    extraVolumes:
      - name: users
        configMap:
          name: authelia-configmap
          items:
            - key: users.yaml
              path: users.yaml
  configMap:
    log:
      level: info
    telemetry:
      metrics:
        enabled: true
        serviceMonitor:
          enabled: true
    default_redirection_url: https://amrap030.site
    theme: dark
    webauthn:
      display_name: auth-external@infrastructure
    authentication_backend:
      password_reset:
        disable: true
      ldap:
        enabled: false
      file:
        enabled: true
        path: /users.yaml
        search:
          email: true
        password:
          algorithm: argon2
    access_control:
      secret:
        enabled: true
      rules:
        - policy: two_factor
          domain: '*.${DOMAIN_EXTERNAL}'
          subject:
            - group:admins
    session:
      inactivity: 10m
      redis:
        host: redis.services.svc.cluster.local
    storage:
      local:
        enabled: true
        path: /config/db.sqlite3
      postgres:
        enabled: false
    notifier:
      smtp:
        enabledSecret: true
        host: ${SMTP_HOST}
        port: 587
        username: ${SMTP_ACCOUNT_AUTH_EMAIL}
        sender: ${SMTP_ACCOUNT_AUTH_EMAIL}
        subject: '[auth@infrastructure] {title}'
  secret:
    existingSecret: authelia-secrets
  persistence:
    enabled: true
    storageClass: longhorn
    existingClaim: authelia-data